<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paddy Inventory</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="assets/img/favicon.ico" type="image/x-icon">
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="assets/img/codeio.png" width="auto" height="30" alt="Logo">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="index.html">Inventory</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="invoice.html">Invoice</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="bag.html">Gunny Bags</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Accounts</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <form class="container">
        <div class="form-group row">
            <label for="paddy" class="col-sm-2 col-form-label">Paddy Type</label>
            <div class="col-sm-10">
                <select class="form-control" name="paddy" id="paddy">
                    <option value="gundu">Gundu Nel</option>
                    <option value="mav">Mav Nel</option>
                </select>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="custName" class="col-sm-2 col-form-label">Issuer Name</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="custName" id="custName" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="city" class="col-sm-2 col-form-label">Location</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="city" id="city" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="netWeight" class="col-sm-2 col-form-label">Net Weight quantity</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="netWeight" id="netWeight" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="emptyWeight" class="col-sm-2 col-form-label">Empty Weight quantity</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="emptyWeight" id="emptyWeight" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="perBag" class="col-sm-2 col-form-label">Quantity per bag</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="perBag" id="perBag" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="load" class="col-sm-2 col-form-label">Load quantity</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="load" id="load" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="amountPerBag" class="col-sm-2 col-form-label">Amount per bag</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="amountPerBag" id="amountPerBag" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="totalAmount" class="col-sm-2 col-form-label">Total Amount</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="totalAmount" id="totalAmount" required>
                <div id="amountText" style="padding: 0px 10px;font-size: 14px;font-weight: 500;color: #758b89;">
                </div>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="vehicleNo" class="col-sm-2 col-form-label">Vehicle No</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="vehicleNo" id="vehicleNo" required>
                <div class="invalid-feedback">
                    Please enter a value
                </div>
            </div>
        </div>
        <div class="form-group row">
            <button class="btn btn-primary btn-lg btn-block" id="addBtn">Add to Inventory</button>
        </div>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
</body>
<script>
    $(document).ready(function () {
        $("#addBtn").click(function (event) {
            event.preventDefault();
            var formValid = true;
            $("input[required]").each(function () {
                if ($.trim($(this).val()).length == 0) {
                    $(this).addClass("is-invalid");
                    $(this).closest(".form-group").find(".invalid-feedback").show();
                    formValid = false;
                } else {
                    $(this).removeClass("is-invalid");
                    $(this).closest(".form-group").find(".invalid-feedback").hide();
                }
            });

            if (formValid) {
                var paddyType = $("#paddy").val();
                var issuer = $("#custName").val();
                var location = $("#city").val();
                var loadQuant = $("#load").val();
                var emptyWeight = $("#emptyWeight").val();
                var netWeight = $("#netWeight").val();
                var perBag = $("#perBag").val();
                var amountPerBag = $("#amountPerBag").val();
                var totalAmount = $("#totalAmount").val();
                var vehicleNo = $("#vehicleNo").val();
                var json_data = {
                    "paddyType": paddyType,
                    "issuer": issuer,
                    "location": location,
                    "loadQuant": loadQuant,
                    "emptyWeight": emptyWeight,
                    "netWeight": netWeight,
                    "perBag": perBag,
                    "amountPerBag": amountPerBag,
                    "totalAmount": totalAmount,
                    "vehicleNo": vehicleNo,
                    "type": "add"
                };
                $.ajax({
                    url: 'controller.php',
                    type: 'POST',
                    data: json_data,
                    success: function (data) {
                        const obj = JSON.parse(data);
                        $("#custName").val("");
                        $("#city").val("");
                        $("#load").val("");
                        $("#emptyWeight").val("");
                        $("#netWeight").val("");
                        $("#perBag").val("");
                        $("#amountPerBag").val("");
                        $("#totalAmount").val("");
                        $("#vehicleNo").val("");
                        window.location.href = "invoice.html";
                    }
                });
            }
        });

        function numberToText(num) {
            var ones = ["", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine"];
            var tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"];
            var teens = ["ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"];

            if (num == 0) {
                return "zero";
            } else if (num < 0) {
                return "minus " + numberToText(Math.abs(num));
            }

            var text = "";

            if (num >= 10000000) {
                text += numberToText(Math.floor(num / 10000000)) + " crore ";
                num %= 10000000;
            }

            if (num >= 100000) {
                text += numberToText(Math.floor(num / 100000)) + " lakh ";
                num %= 100000;
            }

            if (num >= 1000) {
                text += numberToText(Math.floor(num / 1000)) + " thousand ";
                num %= 1000;
            }

            if (num >= 100) {
                text += ones[Math.floor(num / 100)] + " hundred ";
                num %= 100;
            }

            if (num >= 10 && num <= 19) {
                text += teens[num - 10];
                num = 0;
            } else if (num >= 20 || num == 0) {
                text += tens[Math.floor(num / 10)];
                num %= 10;
                if (num != 0) {
                    text += "-";
                }
            }

            if (num > 0) {
                text += ones[num];
            }

            return text.trim().charAt(0).toUpperCase() + text.slice(1);
        }

        function convert_load_quan() {
            var perBag = $("#perBag").val();
            var netWeight = $("#netWeight").val();
            var emptyWeight = $("#emptyWeight").val();
            var loadQuant = (netWeight - emptyWeight) / perBag;
            var beforeDecimal = Math.floor(loadQuant);
            var afterDecimal = Math.abs(loadQuant - beforeDecimal);
            var deciCond = afterDecimal === 0.00 ? '' : parseInt(((afterDecimal.toFixed(2)) * perBag), 10) + " Kgs ";
            var loadQuant1 = beforeDecimal + " bag " + deciCond;
            $("#load").val($.isNumeric(loadQuant) ? loadQuant1 : 0);
            var amountPerBag = $("#amountPerBag").val();
            var totalAmountText = $.isNumeric(amountPerBag) ? parseInt((beforeDecimal + afterDecimal) * amountPerBag, 10) : 0;
            $("#totalAmount").val(totalAmountText);
            $("#amountText").text(numberToText(totalAmountText));
        };

        $("#emptyWeight").on("change", function () {
            convert_load_quan();
        });

        $("#netWeight").on("change", function () {
            convert_load_quan();
        });

        $("#perBag").on("change", function () {
            convert_load_quan();
        });

        $("#amountPerBag").on("change", function () {
            convert_load_quan();
        });
    });
</script>

</html>